
This repository contains code for analyzing data and generating figures for the study titled  
**‚ÄúAbsence of Systematic Effects of Internalizing Psychopathology on Learning Under Uncertainty.‚Äù**

---

## üìÅ Project Structure

- **`figure_codes/`**  
  Scripts organized by figure number, corresponding to the main manuscript.

- **`data/`**  
  Contains all datasets used for the analysis.

- **`figures/`**  
  Stores figures generated by the analysis scripts.

- **`functions/`**  
  Contains helper functions used in the analysis scripts.

- **`lab_scr_analysis/`**  
  Code for analyzing SCR (skin conductance response) data.  
  Referenced from `figure_6.py` in `figure_codes/`.

- **`predator_rbm_model/`**
  Code for implementing the reduced Bayesian model (RBM) and corresponding regression on the predator task data.

- **`reversal_task_model/`**  
  Code for implementing the models for the reversal learning task.

- **`bifactor_analysis.ipynb`**  
  Jupyter notebook (uses R kernel) for performing bifactor analysis on questionnaire data.  
  Requires the environment `factor_analysis_env.yml`.

---

## üõ†Ô∏è Environment Requirements

Different analysis scripts use different Python environments. Use the environment files below to recreate the required dependencies:

| Scripts                 | Environment File            |
|-------------------------|-----------------------------|
| figure_1-5.py           | `predator_task_env.yml`     |
| figure_6.py             | `lab_study_env.yml`         |
| figure_7.py             | `predator_task_env.yml`     |
| figure_8.py             | `reversal_learning_env.yml` |
| run_rbm_model.py        | `predator_task_env.yml`     |
| run_prl_fit_model.py    | `reversal_learning_env.yml` |
| bifactor_analysis.ipynb | `factor_analysis_env.yml`   |

---

##  Reduced Bayesian Model (RBM) ‚Äî Predator Task

The RBM implementation for the predator task is in the `predator_rbm_model/` folder.  
The code is based on the following repositories:

- [rbm_analyses](https://github.com/rasmusbruckner/rbm_analyses)  
- [all_in](https://github.com/rasmusbruckner/all_in)

To run the RBM model on the predator task data, use the `run_rbm_model.py` script with the `predator_task_env.yml` environment.


---

## Reversal Learning Task Models
Hierarchical Bayesian models for reversal learning are implemented in reversal_task_model/.
These are based on extensions of the Rescorla-Wagner framework from Gagne et al. (2020).
These models can be run on the data using the `run_prl_fit_model.py` script, using the `reversal_learning_env.yml` environment.

---
## üìä Bifactor Analysis
The bifactor analysis of the questionnaire data is performed in the `bifactor_analysis.ipynb` notebook.
This notebook uses the R kernel and requires the `factor_analysis_env.yml` environment.




## üìú References
- Gagne, C., Zika, O., Dayan, P., & Bishop, S. J. (2020). Impaired adaptation of learning to contingency volatility in internalizing psychopathology. eLife, 9, e61387. https://doi.org/10.7554/eLife.61387








